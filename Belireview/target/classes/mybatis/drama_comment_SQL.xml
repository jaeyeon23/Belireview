<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC " - //mybatis.org//DTD Config 3.0//EN" " http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="drama_comment">

<!-- insert>
INSERT INTO DRAMA_COMMENT 
(
  DRAMA_NO,
  DC_NO,
  ID,
  DC_REG_DATE,
  DC_CONTENT,
  DC_LIKE,
  DC_LIKE_ID
)
VALUES
(
  SEQ_DRAMA_COMMENT_NO.NEXTVAL,
  #{DRAMA_NO},
  #{DC_NO},
  #{ID},
  #{DC_REG_DATE},
  #{DC_CONTENT},
  #{DC_LIKE},
  #{DC_LIKE_ID}
);
</insert> -->

	<!-- 댓글 최신순 -->
	<select id="dramaCommentByRecent" parameterType="hashmap" resultType="hashmap">
		SELECT
			  DRAMA_NO,
			  DC_NO,
			  ID,
			  DC_REG_DATE,
			  DC_CONTENT,
			  DC_LIKE,
			  DC_LIKE_ID,
			  DL_GRADE,
			  RNUM FROM 
			  (SELECT
			     DRAMA_NO,
			     DC_NO,
			     ID,
			     DC_REG_DATE,
			     DC_CONTENT,
			     DC_LIKE,
			     DC_LIKE_ID,
			     TO_CHAR(DL_GRADE,'0.0') AS DL_GRADE,
			     ROWNUM RNUM FROM 
			    (SELECT DC.DRAMA_NO, DC.DC_NO,DC.ID,DC.DC_REG_DATE,DC.DC_CONTENT,DC.DC_LIKE,DC.DC_LIKE_ID,DL.DL_GRADE FROM DRAMA_LIKE DL, DRAMA_COMMENT DC
			      WHERE DL.DRAMA_LIKE_NO=DC.DRAMA_NO AND DL.ID=DC.ID ORDER BY DC_REG_DATE DESC) ORDER BY RNUM ASC) WHERE RNUM BETWEEN 1 AND 3
	</select>
	
	
	<!-- 댓글 좋아요 순 -->
	<select id="dramaCommentByLike" parameterType="hashmap" resultType="hashmap">
		SELECT
		  DRAMA_NO,
		  DC_NO,
		  ID,
		  DC_REG_DATE,
		  DC_CONTENT,
		  DC_LIKE,
		  DC_LIKE_ID,
		  DL_GRADE,
		  RNUM FROM 
		  (SELECT
		     DRAMA_NO,
		     DC_NO,
		     ID,
		     DC_REG_DATE,
		     DC_CONTENT,
		     DC_LIKE,
		     DC_LIKE_ID,
		    	TO_CHAR(DL_GRADE,'0.0') AS DL_GRADE,
		     ROWNUM RNUM FROM 
		    (SELECT DC.DRAMA_NO, DC.DC_NO,DC.ID,DC.DC_REG_DATE,DC.DC_CONTENT,DC.DC_LIKE,DC.DC_LIKE_ID,DL.DL_GRADE FROM DRAMA_LIKE DL, DRAMA_COMMENT DC
		      WHERE DL.DRAMA_LIKE_NO=DC.DRAMA_NO AND DL.ID=DC.ID ORDER BY DC_LIKE DESC) ORDER BY RNUM ASC) WHERE RNUM BETWEEN 1 AND 3
	</select>
	
	<select id="totalDramaComment" parameterType="hashmap" resultType="int">
		select count(*) as count from DRAMA_COMMENT where DRAMA_NO = 1
	</select>


</mapper>
