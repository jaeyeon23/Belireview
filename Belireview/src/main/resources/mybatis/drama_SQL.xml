<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC " - //mybatis.org//DTD Config 3.0//EN" " http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="drama">

  <select id="selectBoardList" parameterType="hashmap" resultType="hashmap" >
  <![CDATA[
 		SELECT
 			DRAMA_NO,
			DRAMA_NAME,
			DRAMA_DATE,
			DRAMA_CHANNEL,
			DRAMA_GENRE,
			DRAMA_DIRECTOR,
			DRAMA_CONTENT,
			DRAMA_READCOUNT,
			DRAMA_POSTER_IMAGE,
			DRAMA_MAIN_IMAGE,
			DRAMA_CONTENT_IMAGE,
			DRAMA_EPISODE,
			DRAMA_GRADE,
			RNUM FROM 
			(
		SELECT
				DRAMA_NO,
				DRAMA_NAME,
				to_char(DRAMA_DATE,'yyyy') as DRAMA_DATE,
				DRAMA_CHANNEL,
				DRAMA_GENRE,
				DRAMA_DIRECTOR,
				DRAMA_CONTENT,
				DRAMA_READCOUNT,
				DRAMA_POSTER_IMAGE,
				DRAMA_MAIN_IMAGE,
				DRAMA_CONTENT_IMAGE,
				DRAMA_EPISODE,
				DRAMA_GRADE,
				ROWNUM RNUM FROM 
				(SELECT *
					FROM DRAMA ORDER BY DRAMA_DATE DESC) ORDER BY RNUM ASC) WHERE RNUM BETWEEN #{START} AND #{END}
		]]>
   </select>
   
   <select id="totalDramaCount" parameterType="hashmap" resultType="int">
   		SELECT COUNT(*) AS COUNT FROM DRAMA
   </select>
   
   <select id="dramaDetail" parameterType="hashmap" resultType="hashmap">
	   	SELECT
	   		DRAMA_NO,
			DRAMA_NAME,
			TO_CHAR(DRAMA_DATE,'yyyy') AS DRAMA_DATE,
			DRAMA_CHANNEL,
			DRAMA_GENRE,
			DRAMA_DIRECTOR,
			DRAMA_CONTENT,
			DRAMA_READCOUNT,
			DRAMA_POSTER_IMAGE,
			DRAMA_MAIN_IMAGE,
			DRAMA_CONTENT_IMAGE,
			DRAMA_EPISODE,
			(SELECT AVG(DL_GRADE)
			FROM DRAMA_LIKE WHERE DRAMA_LIKE_NO = #{DRAMA_NO}) 
			AS DRAMA_GRADE 
		FROM DRAMA WHERE DRAMA_NO = #{DRAMA_NO}
   </select>
 
   
   <select id="dramaActor" parameterType="hashmap" resultType="hashmap">
   		SELECT ACTOR_NAME,ACTOR_IMAGE FROM ACTOR WHERE ACTOR_DRAMA LIKE '%'||#{DRAMA_NAME}||'%'
   </select>
   
   <insert id="insertDrama"  parameterType="hashmap">
   INSERT INTO DRAMA(	
	DRAMA_NO,
	DRAMA_NAME,
    DRAMA_DATE,
    DRAMA_CHANNEL,
    DRAMA_GENRE,
    DRAMA_DIRECTOR,
    DRAMA_CONTENT,
    DRAMA_READCOUNT,
    DRAMA_POSTER_IMAGE,
    DRAMA_MAIN_IMAGE,
    DRAMA_CONTENT_IMAGE,
    DRAMA_EPISODE,
    DRAMA_GRADE,
)
values (
	SEQ_DRAMA_NO.NEXTVAL,
	#{DRAMA_NAME},
	#{DRAMA_DATE},
	#{DRAMA_CHANNEL},
	#{DRAMA_GENRE},
	#{DRAMA_DIRECTOR},
	#{DRAMA_CONTENT},
	0,
	#{DRAMA_POSTER_IMAGE},
	#{DRAMA_MAIN_IMAGE},
	#{DRAMA_CONTENT_IMAGE},
	#{DRAMA_EPISODE},
	0
);
</insert>


	<!-- <select>
		SELECT * FROM DRAMA WHERE DRAMA_NO=#{DRAMA_NO}
	</select>
	
수정	
	<update>
	UPDATE DRAMA SET 
		DRAMA_NAME=#{DRAMA_NAME},
		DRAMA_DATE=#{DRAMA_DATE},
		DRAMA_CHANNEL=#{DRAMA_CHANNEL},
		DRAMA_GENRE=#{DRAMA_GENRE},
		DRAMA_DIRECTOR=#{DRAMA_DIRECTOR},
		DRAMA_CONTENT=#{DRAMA_CONTENT},
		DRAMA_POSTER_IMAGE=#{DRAMA_POSTER_IMAGE},
		DRAMA_MAIN_IMAGE=#{DRAMA_MAIN_IMAGE},
		DRAMA_CONTENT_IMAGE=#{CONTENT_IMAGE},
		DRAMA_EPISODE=#{EPISODE}
	WHERE DRAMA_NO=#{DRAMA_NO}	
	</update>

삭제
	<delete>
		DELETE DRAMA WHERE DRAMA_NO=#{DRAMA_NO}
	</delete> -->

</mapper>